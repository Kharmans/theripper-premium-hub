/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var t={d:(r,o)=>{for(var i in o)t.o(o,i)&&!t.o(r,i)&&Object.defineProperty(r,i,{enumerable:!0,get:o[i]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r)};function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function _objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(o),!0).forEach((function(r){_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function _defineProperty(t,r,o){return(r=_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function _toPropertyKey(t){var r=function _toPrimitive(t,r){if("object"!==_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===_typeof(r)?r:String(r)}t.d({},{n:()=>U,D:()=>D});function utils_confirm(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=l(t),r=l(r),foundry.applications.api.DialogV2.confirm(_objectSpread({window:{title:t},width:400,content:r,rejectClose:!1},o))}function utils_prompt(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=l(t),r=l(r),foundry.applications.api.DialogV2.prompt(_objectSpread({window:{title:t},content:r},o))}function deepClone(t){return foundry.utils.deepClone(t)}function l(t){return game.i18n.localize(t)}function TheRipperPremiumHUB_typeof(t){return TheRipperPremiumHUB_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TheRipperPremiumHUB_typeof(t)}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_unsupportedIterableToArray(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,u=!0,d=!1;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){d=!0,c=t},f:function f(){try{u||null==o.return||o.return()}finally{if(d)throw c}}}}function _slicedToArray(t,r){return function _arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function _iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,c,u,d=[],p=!0,h=!1;try{if(c=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;p=!1}else for(;!(p=(i=c.call(o)).done)&&(d.push(i.value),d.length!==r);p=!0);}catch(t){h=!0,a=t}finally{try{if(!p&&null!=o.return&&(u=o.return(),Object(u)!==u))return}finally{if(h)throw a}}return d}}(t,r)||_unsupportedIterableToArray(t,r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function TheRipperPremiumHUB_regeneratorRuntime(){TheRipperPremiumHUB_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),d=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,d)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var h={};define(h,c,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(values([])));m&&m!==r&&o.call(m,c)&&(h=m);var v=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(h);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var d=tryCatch(t[i],t,a);if("throw"!==d.type){var p=d.arg,h=p.value;return h&&"object"==TheRipperPremiumHUB_typeof(h)&&o.call(h,"__await")?r.resolve(h.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(h).then((function(t){p.value=t,c(p)}),(function(t){return invoke("throw",t,c,u)}))}u(d.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var d=maybeInvokeDelegate(u,o);if(d){if(d===p)continue;return d}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var h=tryCatch(t,r,o);if("normal"===h.type){if(i=o.done?"completed":"suspendedYield",h.arg===p)continue;return{value:h.arg,done:o.done}}"throw"===h.type&&(i="completed",o.method="throw",o.arg=h.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(v,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,d,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,d,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(v),define(v,d,"Generator"),define(v,c,(function(){return this})),define(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),d=o.call(a,"finallyLoc");if(u&&d){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,p):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function TheRipperPremiumHUB_asyncGeneratorStep(t,r,o,i,a,c,u){try{var d=t[c](u),p=d.value}catch(t){return void o(t)}d.done?r(p):Promise.resolve(p).then(i,a)}function TheRipperPremiumHUB_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){TheRipperPremiumHUB_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){TheRipperPremiumHUB_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function TheRipperPremiumHUB_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(a=i.key,c=void 0,c=function TheRipperPremiumHUB_toPrimitive(t,r){if("object"!==TheRipperPremiumHUB_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==TheRipperPremiumHUB_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(a,"string"),"symbol"===TheRipperPremiumHUB_typeof(c)?c:String(c)),i)}var a,c}var r=function(){function TheRipperPremiumHUB(){!function TheRipperPremiumHUB_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,TheRipperPremiumHUB),this.outdatedModules={},this.announcementsHtml="",this._debug=!1,this.converter=new showdown.Converter,this.init()}var t,r,o,i,a,c,u,d,p;return function TheRipperPremiumHUB_createClass(t,r,o){return r&&TheRipperPremiumHUB_defineProperties(t.prototype,r),o&&TheRipperPremiumHUB_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(TheRipperPremiumHUB,[{key:"repositoryIndex",get:function get(){return{megapack:"megapack","vtt-desktop-client":"fvtt-player-client",levels:"Levels",enhancedcombathud:"enhancedcombathud","automated-evocations":"automated-evocations",betterroofs:"Better-Roofs","combat-tracker-dock":"combat-tracker-dock",bossbar:"Boss-Bar",combatbooster:"Combat-Booster","fuzzy-foundry":"fuzzy-foundry","hover-distance":"hover-distance","hurry-up":"hurry-up",levelsautocover:"levelsautocover",levelsvolumetrictemplates:"levelsvolumetrictemplates",patrol:"Patrol","damage-numbers":"damage-numbers",smarttarget:"Smart-Target",splatter:"splatter","dnd-randomizer":"dnd-randomizer","tile-sort":"tile-sort","tile-scroll":"tile-scroll","token-z":"token-z","foundry-taskbar":"foundry-taskbar",quickdraw:"quickdraw","config-presets":"config-presets","light-switch":"light-switch","filepicker-plus":"filepicker-plus","progress-tracker":"progress-tracker","situational-shortcuts":"situational-shortcuts","quick-doors":"quick-doors","image-context":"image-context","inactive-tokens-lmao":"inactive-tokens-lmao","levels-3d-preview":"levels-3d-preview",choices:"choices",mmm:"Maxwell-s-Manual-of-Malicious-Maladies",socketmacros:"socketmacros",tokenflip:"tokenflip","token-notes":"token-notes","wall-height":"wall-height",canvas3dcompendium:"canvas3dcompendium",canvas3dtokencompendium:"canvas3dtokencompendium","theripper-premium-hub":"theripper-premium-hub","levels-layer-effects":"levels-layer-effects","three-actor-portrait":"three-actor-portrait",mastercrafted:"mastercrafted",gatherer:"gatherer","camera-dock":"camera-dock","macro-wheel":"macro-wheel"}}},{key:"init",value:(p=TheRipperPremiumHUB_asyncToGenerator(TheRipperPremiumHUB_regeneratorRuntime().mark((function _callee(){return TheRipperPremiumHUB_regeneratorRuntime().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchData();case 2:this.moduleData=t.sent,this.announcements=this.moduleData.announcements,delete this.moduleData.announcements,this.getOutdatedModules(),game.settings.get("theripper-premium-hub","autoCheck")&&this.displayOutdated(!1),this.displayAnnouncements();case 8:case"end":return t.stop()}}),_callee,this)}))),function init(){return p.apply(this,arguments)})},{key:"getForgeData",value:(d=TheRipperPremiumHUB_asyncToGenerator(TheRipperPremiumHUB_regeneratorRuntime().mark((function _callee2(t){return TheRipperPremiumHUB_regeneratorRuntime().wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch("https://forge-vtt.com/api/bazaar/package/".concat(t)).then((function(t){return t.json()})).then((function(t){return t}));case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),_callee2)}))),function getForgeData(t){return d.apply(this,arguments)})},{key:"getOutdatedModules",value:function getOutdatedModules(){for(var t=game.settings.get("theripper-premium-hub","checkDisabled"),r=0,o=Object.entries(this.moduleData);r<o.length;r++){var i=_slicedToArray(o[r],2),a=i[0],c=i[1],u=game.modules.get(a);u&&((t||null!=u&&u.active)&&(foundry.utils.isNewerVersion(c.version,u.version)||this._debug)&&(this.outdatedModules[a]=c,this.outdatedModules[a].title=u.title,this.outdatedModules[a].currentVersion=u.version))}}},{key:"displayOutdated",value:(u=TheRipperPremiumHUB_asyncToGenerator(TheRipperPremiumHUB_regeneratorRuntime().mark((function _callee3(){var t,r,o,i,a,c,u,d,p,h,y,m,v,g,b,w=arguments;return TheRipperPremiumHUB_regeneratorRuntime().wrap((function _callee3$(_){for(;;)switch(_.prev=_.next){case 0:if(t=w.length>0&&void 0!==w[0]&&w[0],0!==Object.keys(this.outdatedModules).length){_.next=3;break}return _.abrupt("return",t?ui.notifications.info("No outdated modules found."):null);case 3:if(r={},t){_.next=17;break}o=game.settings.get("theripper-premium-hub","viewedUpdates"),i=0,a=Object.entries(this.outdatedModules);case 7:if(!(i<a.length)){_.next=15;break}if(c=_slicedToArray(a[i],2),u=c[0],d=c[1],!o[u]||d.version!==o[u]){_.next=11;break}return _.abrupt("continue",12);case 11:r[u]=d;case 12:i++,_.next=7;break;case 15:_.next=18;break;case 17:r=this.outdatedModules;case 18:if(0!==Object.keys(r).length){_.next=20;break}return _.abrupt("return",null);case 20:return _.next=22,renderTemplate("modules/theripper-premium-hub/templates/modlist.hbs",r);case 22:return p=_.sent,_.next=25,utils_prompt("TheRipper93 Premium HUB - Updates Available!",p);case 25:if(_.sent){for(console.log("Confirmed updates"),h=game.settings.get("theripper-premium-hub","viewedUpdates"),y=0,m=Object.entries(this.outdatedModules);y<m.length;y++)v=_slicedToArray(m[y],2),g=v[0],b=v[1],h[g]=b.version;game.settings.set("theripper-premium-hub","viewedUpdates",h)}case 27:case"end":return _.stop()}}),_callee3,this)}))),function displayOutdated(){return u.apply(this,arguments)})},{key:"displayAnnouncements",value:(c=TheRipperPremiumHUB_asyncToGenerator(TheRipperPremiumHUB_regeneratorRuntime().mark((function _callee4(){var t,r,o,i,a,c;return TheRipperPremiumHUB_regeneratorRuntime().wrap((function _callee4$(u){for(;;)switch(u.prev=u.next){case 0:if(r=this.announcements){u.next=3;break}return u.abrupt("return");case 3:return o=Object.keys(r),i=null!==(t=game.settings.get("theripper-premium-hub","viewedAnnouncements"))&&void 0!==t?t:"",a=o.every((function(t){return i.includes(t)})),u.next=8,renderTemplate("modules/theripper-premium-hub/templates/announcements.hbs",r);case 8:if(c=u.sent,this.announcementsHtml=c,!a||this._debug){u.next=12;break}return u.abrupt("return");case 12:game.settings.set("theripper-premium-hub","viewedAnnouncements",o.join(",")),Dialog.prompt({title:"TheRipper93 Premium HUB - Announcement!",content:c+'    <p style="text-align: center;">Want to support me and get access to premium modules?</p><hr>\n      <p style="text-align: center;"><a href="https://theripper93.com/" target="_blank" rel="nofollow" title="https://theripper93.com/">Check out my Website</a></p>',rejectClose:!1,callback:function callback(){},close:function close(){}});case 14:case"end":return u.stop()}}),_callee4,this)}))),function displayAnnouncements(){return c.apply(this,arguments)})},{key:"fetchData",value:(a=TheRipperPremiumHUB_asyncToGenerator(TheRipperPremiumHUB_regeneratorRuntime().mark((function _callee5(){var t,r,o,i,a=this;return TheRipperPremiumHUB_regeneratorRuntime().wrap((function _callee5$(c){for(;;)switch(c.prev=c.next){case 0:return t=game.modules.filter((function(t){return t.authors&&t.authors.some((function(t){return"theripper93"===t.name}))})),c.next=3,this.fetchAnnouncements();case 3:return r=c.sent,o=t.map((function(t){return a.fetchModuleData(t)})),i={},c.next=8,Promise.all(o).then((function(t){t.forEach((function(t){t&&(i[t.id]=t)}))}));case 8:return i.announcements=r.announcements,game.settings.set("theripper-premium-hub","lastGitCheck",Date.now()),c.abrupt("return",i);case 11:case"end":return c.stop()}}),_callee5,this)}))),function fetchData(){return a.apply(this,arguments)})},{key:"fetchModuleData",value:(i=TheRipperPremiumHUB_asyncToGenerator(TheRipperPremiumHUB_regeneratorRuntime().mark((function _callee6(t){var r,o,i,a,c,u,d;return TheRipperPremiumHUB_regeneratorRuntime().wrap((function _callee6$(p){for(;;)switch(p.prev=p.next){case 0:if(game.settings.get("theripper-premium-hub","checkDisabled")||t.active){p.next=3;break}return p.abrupt("return",null);case 3:return i=null==t||null===(r=t.manifest)||void 0===r?void 0:r.includes("foundryvtt"),a=t.id,c=null!==(o=this.repositoryIndex[a])&&void 0!==o?o:a,p.next=9,this.getAllReleasesFromGitHub("theripper93",c,i,t);case 9:if(u=p.sent){p.next=12;break}return p.abrupt("return",null);case 12:if(d=Object.keys(u).sort((function(t,r){return foundry.utils.isNewerVersion(r,t)}))[0]){p.next=15;break}return p.abrupt("return",null);case 15:return p.abrupt("return",{version:d,title:t.title,changelog:u,latestChangeLog:this.converter.makeHtml(u[d]),id:a});case 16:case"end":return p.stop()}}),_callee6,this)}))),function fetchModuleData(t){return i.apply(this,arguments)})},{key:"getAllReleasesFromGitHub",value:(o=TheRipperPremiumHUB_asyncToGenerator(TheRipperPremiumHUB_regeneratorRuntime().mark((function _callee7(t,r,o,i){var a,c,u,d,p,h,y,m,v,g,b,w,_,k,x;return TheRipperPremiumHUB_regeneratorRuntime().wrap((function _callee7$(P){for(;;)switch(P.prev=P.next){case 0:if(c=null!==(a=game.settings.get("theripper-premium-hub","lastGitCheck"))&&void 0!==a?a:0,!o){P.next=27;break}return u="https://raw.githubusercontent.com/theripper93/theripper-premium-hub/master/premium-changelogs/".concat(r,".md"),P.prev=3,P.next=6,fetch(u);case 6:if((d=P.sent).ok){P.next=9;break}return P.abrupt("return",null);case 9:return P.next=11,d.text();case 11:if(p=P.sent){P.next=14;break}return P.abrupt("return",null);case 14:h={},y=p.split(/\r?\n/),m="",v=_createForOfIteratorHelper(y);try{for(v.s();!(g=v.n()).done;)(b=g.value).startsWith("##")?(w=b.replace("## Version ",""),h[w]="",m=w):""!=b.trim()&&(h[m]+=b+"\n")}catch(t){v.e(t)}finally{v.f()}return P.abrupt("return",h);case 22:return P.prev=22,P.t0=P.catch(3),P.abrupt("return",null);case 25:P.next=47;break;case 27:if(!(Date.now()-c<36e5)){P.next=29;break}return P.abrupt("return",null);case 29:return _="https://api.github.com/repos/".concat(t,"/").concat(r,"/releases?per_page=").concat(10),P.prev=31,k={},P.next=35,fetch("".concat(_,"&page=1"));case 35:return 404!==(x=P.sent).status||i.download||ui.notifications.error("The module <strong>".concat(i.title,'</strong> is still installed using the old manual installation, please switch to the new Foundry/Patreon integration. <a href="https://theripper93.com/info/installation" target="_blank" rel="nofollow">More Information</a>'),{permanent:!0}),P.next=39,x.json();case 39:return P.sent.forEach((function(t){k[t.tag_name]=t.body})),P.abrupt("return",k);case 44:return P.prev=44,P.t1=P.catch(31),P.abrupt("return",null);case 47:case"end":return P.stop()}}),_callee7,null,[[3,22],[31,44]])}))),function getAllReleasesFromGitHub(t,r,i,a){return o.apply(this,arguments)})},{key:"fetchAnnouncements",value:(r=TheRipperPremiumHUB_asyncToGenerator(TheRipperPremiumHUB_regeneratorRuntime().mark((function _callee8(){var t;return TheRipperPremiumHUB_regeneratorRuntime().wrap((function _callee8$(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",{announcements:{}});case 4:return t=r.sent,r.abrupt("return",t["v".concat(game.version.split(".")[0])]);case 8:return r.prev=8,r.t0=r.catch(1),console.warn("Error fetching announcements",r.t0),r.abrupt("return",{announcements:{}});case 12:case"end":return r.stop()}}),_callee8,null,[[1,8]])}))),function fetchAnnouncements(){return r.apply(this,arguments)})},{key:"_getdataforfile",value:function _getdataforfile(){var t=this,r={};return game.modules.forEach((function(o,i){var a,c;o.authors&&o.authors.some((function(t){return"theripper93"===t.name}))&&o.manifest.includes("foundryvtt")&&(r[i]={title:o.title,version:o.version,downloadURL:null!==(a=null===(c=t.moduleData[i])||void 0===c?void 0:c.downloadURL)&&void 0!==a?a:""})})),r}},{key:"getDependencies",value:function getDependencies(t){var r=game.modules.get(t),o=new Set;return function addDependecies(t){Array.from(t.relationships.requires).map((function(t){return game.modules.get(t.id)})).forEach((function(t){o.add(t),addDependecies(t)}))}(r),o}},{key:"troubleshoot",value:(t=TheRipperPremiumHUB_asyncToGenerator(TheRipperPremiumHUB_regeneratorRuntime().mark((function _callee9(t){var r,o,i,a,c,u,d,p;return TheRipperPremiumHUB_regeneratorRuntime().wrap((function _callee9$(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,utils_confirm("TheRipper93 Premium HUB - Troubleshoot","<p>Do you want to start the troubleshoot for ".concat(game.modules.get(t).title,"?</p><br><p>This will disable all modules except the one you selected and its dependencies. You will be prompted to restore your modules after the troubleshoot.</p>"));case 2:if(h.sent){h.next=5;break}return h.abrupt("return");case 5:r=this.getDependencies(t),o=[].concat(_toConsumableArray(Array.from(r).map((function(t){return t.id}))),[t,"theripper-premium-hub"]),i=game.settings.get("core",ModuleManagement.CONFIG_SETTING),a=[],c=0,u=Object.entries(i);case 10:if(!(c<u.length)){h.next=19;break}if(d=_slicedToArray(u[c],2),p=d[0],d[1]&&a.push(p),!o.includes(p)){h.next=15;break}return h.abrupt("continue",16);case 15:i[p]=!1;case 16:c++,h.next=10;break;case 19:return h.next=21,game.settings.set("theripper-premium-hub","prevEnabledModules",a);case 21:return h.next=23,game.settings.set("core",ModuleManagement.CONFIG_SETTING,i);case 23:foundry.utils.debouncedReload();case 24:case"end":return h.stop()}}),_callee9,this)}))),function troubleshoot(r){return t.apply(this,arguments)})}]),TheRipperPremiumHUB}();function formBuilder_typeof(t){return formBuilder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},formBuilder_typeof(t)}function formBuilder_toConsumableArray(t){return function formBuilder_arrayWithoutHoles(t){if(Array.isArray(t))return formBuilder_arrayLikeToArray(t)}(t)||function formBuilder_iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||formBuilder_unsupportedIterableToArray(t)||function formBuilder_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function formBuilder_createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=formBuilder_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,u=!0,d=!1;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){d=!0,c=t},f:function f(){try{u||null==o.return||o.return()}finally{if(d)throw c}}}}function formBuilder_unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return formBuilder_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?formBuilder_arrayLikeToArray(t,r):void 0}}function formBuilder_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function formBuilder_get(){return formBuilder_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=function formBuilder_superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=formBuilder_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}},formBuilder_get.apply(this,arguments)}function formBuilder_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&formBuilder_setPrototypeOf(t,r)}function formBuilder_setPrototypeOf(t,r){return formBuilder_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},formBuilder_setPrototypeOf(t,r)}function formBuilder_createSuper(t){var r=function formBuilder_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=formBuilder_getPrototypeOf(t);if(r){var a=formBuilder_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function formBuilder_possibleConstructorReturn(t,r){if(r&&("object"===formBuilder_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return formBuilder_assertThisInitialized(t)}(this,o)}}function formBuilder_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function formBuilder_getPrototypeOf(t){return formBuilder_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},formBuilder_getPrototypeOf(t)}function formBuilder_ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function formBuilder_objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?formBuilder_ownKeys(Object(o),!0).forEach((function(r){formBuilder_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):formBuilder_ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function formBuilder_defineProperty(t,r,o){return(r=formBuilder_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function formBuilder_regeneratorRuntime(){formBuilder_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),d=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,d)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var h={};define(h,c,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(values([])));m&&m!==r&&o.call(m,c)&&(h=m);var v=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(h);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var d=tryCatch(t[i],t,a);if("throw"!==d.type){var p=d.arg,h=p.value;return h&&"object"==formBuilder_typeof(h)&&o.call(h,"__await")?r.resolve(h.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(h).then((function(t){p.value=t,c(p)}),(function(t){return invoke("throw",t,c,u)}))}u(d.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var d=maybeInvokeDelegate(u,o);if(d){if(d===p)continue;return d}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var h=tryCatch(t,r,o);if("normal"===h.type){if(i=o.done?"completed":"suspendedYield",h.arg===p)continue;return{value:h.arg,done:o.done}}"throw"===h.type&&(i="completed",o.method="throw",o.arg=h.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(v,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,d,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,d,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(v),define(v,d,"Generator"),define(v,c,(function(){return this})),define(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),d=o.call(a,"finallyLoc");if(u&&d){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,p):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function formBuilder_asyncGeneratorStep(t,r,o,i,a,c,u){try{var d=t[c](u),p=d.value}catch(t){return void o(t)}d.done?r(p):Promise.resolve(p).then(i,a)}function formBuilder_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){formBuilder_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){formBuilder_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function formBuilder_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function formBuilder_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,formBuilder_toPropertyKey(i.key),i)}}function formBuilder_createClass(t,r,o){return r&&formBuilder_defineProperties(t.prototype,r),o&&formBuilder_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function formBuilder_toPropertyKey(t){var r=function formBuilder_toPrimitive(t,r){if("object"!==formBuilder_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==formBuilder_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===formBuilder_typeof(r)?r:String(r)}function _classPrivateMethodInitSpec(t,r){_checkPrivateRedeclaration(t,r),r.add(t)}function _classPrivateFieldInitSpec(t,r,o){_checkPrivateRedeclaration(t,r),r.set(t,o)}function _checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateMethodGet(t,r,o){if(!r.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function _classPrivateFieldSet(t,r,o){return function _classApplyDescriptorSet(t,r,o){if(r.set)r.set.call(t,o);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=o}}(t,_classExtractFieldDescriptor(t,r,"set"),o),o}function _classPrivateFieldGet(t,r){return function _classApplyDescriptorGet(t,r){if(r.get)return r.get.call(t);return r.value}(t,_classExtractFieldDescriptor(t,r,"get"))}function _classExtractFieldDescriptor(t,r,o){if(!r.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return r.get(t)}var o="6uy8g1tXqHlhlp65dhiL-genericFormHelper-"+D,i=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,p=new WeakMap,h=new WeakMap,y=new WeakMap,m=new WeakSet,v=function(){function FormBuilder(){formBuilder_classCallCheck(this,FormBuilder),_classPrivateMethodInitSpec(this,m),_classPrivateFieldInitSpec(this,i,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,a,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,c,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,u,{writable:!0,value:{position:{width:560,height:"auto"},window:{}}}),_classPrivateFieldInitSpec(this,d,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,p,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,h,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,y,{writable:!0,value:null}),this.submitButton()}var t,r;return formBuilder_createClass(FormBuilder,[{key:"app",get:function get(){return _classPrivateFieldGet(this,y)}},{key:"render",value:(r=formBuilder_asyncToGenerator(formBuilder_regeneratorRuntime().mark((function _callee(){var t;return formBuilder_regeneratorRuntime().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return(t=this.form()).render(!0),r.abrupt("return",t.promise);case 3:case"end":return r.stop()}}),_callee,this)}))),function render(){return r.apply(this,arguments)})},{key:"form",value:function form(){if(_classPrivateFieldGet(this,y))return _classPrivateFieldGet(this,y);var t=new x({tabs:_classPrivateFieldGet(this,i),fields:_classPrivateFieldGet(this,a),buttons:_classPrivateFieldGet(this,c),options:_classPrivateFieldGet(this,u)});return _classPrivateFieldSet(this,y,t),t}},{key:"getHTML",value:function getHTML(){var t=this.form()._prepareContext();return x.registerPartial(),renderTemplate(o,t)}},{key:"getAsClass",value:function getAsClass(t){var r=formBuilder_objectSpread(formBuilder_objectSpread({},t),{},{tabs:_classPrivateFieldGet(this,i),fields:_classPrivateFieldGet(this,a),buttons:_classPrivateFieldGet(this,c),options:_classPrivateFieldGet(this,u)});return function(t){formBuilder_inherits(_class,t);var o=formBuilder_createSuper(_class);function _class(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return formBuilder_classCallCheck(this,_class),o.call(this,formBuilder_objectSpread(formBuilder_objectSpread({},r),t))}return formBuilder_createClass(_class)}(x)}},{key:"onRender",value:function onRender(t){return _classPrivateFieldGet(this,u).onRender=t,this}},{key:"registerAsMenu",value:function registerAsMenu(){var t,r,o,i,a,c,u,d,p,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},y=h.moduleId,m=h.key,v=h.name,g=h.label,b=h.icon,w=h.hint,_=h.scope,k=h.restricted,x=h.defaultValue,P=h.onChange,S=h.requiresReload;null!==(t=y)&&void 0!==t||(y=D),null!==(r=_)&&void 0!==r||(_="world"),null!==(o=k)&&void 0!==o||(k=!0),null!==(i=x)&&void 0!==i||(x={}),null!==(a=m)&&void 0!==a||(m="settings"),null!==(c=b)&&void 0!==c||(b="fas fa-cogs"),null!==(u=g)&&void 0!==u||(g="Configure"),null!==(d=v)&&void 0!==d||(v="Configuration Menu"),null!==(p=w)&&void 0!==p||(w="Configure the module settings");var T={settingsMenu:{requiresReload:S,onChange:P,moduleId:y,key:m}},E=this.getAsClass(T);return game.settings.registerMenu(y,m+"-menu",{name:v,label:g,hint:w,icon:b,scope:_,restricted:k,type:E}),{getSetting:function getSetting(){return game.settings.get(y,m)},setSetting:function setSetting(t){return game.settings.set(y,m,t)}}}},{key:"insertHTML",value:(t=formBuilder_asyncToGenerator(formBuilder_regeneratorRuntime().mark((function _callee2(t,r){var o,i,a,c,u,d=arguments;return formBuilder_regeneratorRuntime().wrap((function _callee2$(p){for(;;)switch(p.prev=p.next){case 0:return o=d.length>2&&void 0!==d[2]?d[2]:"afterend",p.next=3,this.getHTML();case 3:if(i=p.sent,(a=document.createElement("div")).innerHTML=i,c=a.children[0],u=r?t.querySelector(r):t){p.next=10;break}throw new Error("Element ".concat(r," not found"));case 10:return u.insertAdjacentElement(o,c),p.abrupt("return",c);case 12:case"end":return p.stop()}}),_callee2,this)}))),function insertHTML(r,o){return t.apply(this,arguments)})},{key:"title",value:function title(t){return _classPrivateFieldGet(this,u).window.title=t,this}},{key:"resizable",value:function resizable(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return _classPrivateFieldGet(this,u).window.resizable=t,this}},{key:"info",value:function info(t){return _classPrivateFieldGet(this,u).info=t,this}},{key:"object",value:function object(t){return _classPrivateFieldSet(this,h,t),this}},{key:"size",value:function size(t){var r=t.width,o=t.height;return _classPrivateFieldGet(this,u).position={width:null!=r?r:560,height:null!=o?o:"auto"},this}},{key:"submitButton",value:function submitButton(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.enabled,o=void 0===r||r,i=t.label,a=void 0===i?"Confirm":i,u=t.icon,submitButton={type:"submit",action:"submit",icon:void 0===u?"fa-solid fa-check":u,label:a};return o?_classPrivateFieldGet(this,c).push(submitButton):_classPrivateFieldSet(this,c,_classPrivateFieldGet(this,c).filter((function(t){return"submit"!==t.action}))),this}},{key:"tab",value:function tab(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.id,a=r.group,c=r.icon,u=r.label,p=r.active,h=void 0!==p&&p;if(null!==(t=a)&&void 0!==t||(a="sheet"),!o&&_classPrivateFieldGet(this,d))return _classPrivateFieldSet(this,d,null),this;if(!o)throw new Error("You must provide an id for the tab");var tab={id:o,group:a,icon:c,label:u,active:h,fields:[]};return _classPrivateFieldGet(this,i).push(tab),_classPrivateFieldSet(this,d,tab),this}},{key:"fieldset",value:function fieldset(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).legend;if(!t&&_classPrivateFieldGet(this,p))return _classPrivateFieldSet(this,p,null),this;if(!t)throw new Error("You must provide a legend for the fieldset");var fieldset={legend:t,fieldset:!0,fields:[]};return _classPrivateMethodGet(this,m,_addField2).call(this,fieldset),_classPrivateFieldSet(this,p,fieldset),this}},{key:"html",value:function html(t){var r={html:t};return _classPrivateMethodGet(this,m,_addField2).call(this,r),this}},{key:"text",value:function text(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.StringField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,m,_addField2).call(this,c),this}},{key:"number",value:function number(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c=t.min,u=t.max,d=t.step,p={field:new foundry.data.fields.NumberField,name:r,label:o,hint:i,value:a,min:c,max:u,step:d};return _classPrivateMethodGet(this,m,_addField2).call(this,p),this}},{key:"checkbox",value:function checkbox(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.BooleanField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,m,_addField2).call(this,c),this}},{key:"color",value:function color(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.ColorField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,m,_addField2).call(this,c),this}},{key:"file",value:function file(t){var r,o=t.name,i=t.type,a=t.label,c=t.hint,u=t.value;null!==(r=i)&&void 0!==r||(i="imagevideo");var d=g[i],p=new foundry.data.fields.FilePathField({categories:d});p.categories=[i];var h={field:p,name:o,label:a,hint:c,type:i,value:u};return _classPrivateMethodGet(this,m,_addField2).call(this,h),this}},{key:"select",value:function select(t){var r,o=t.name,i=t.label,a=t.hint,c=t.value,u=t.options,d={field:inferSelectDataType(u)===Number?new foundry.data.fields.NumberField({choices:u,required:!0}):new foundry.data.fields.StringField({choices:u,required:!0,blank:!1}),name:o,label:i,hint:a,value:null!=c?c:null===(r=u[0])||void 0===r?void 0:r.key,options:u};return _classPrivateMethodGet(this,m,_addField2).call(this,d),this}},{key:"multiSelect",value:function multiSelect(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c=t.options,u=inferSelectDataType(c)===Number?new foundry.data.fields.NumberField({choices:c,nullable:!1}):new foundry.data.fields.StringField({choices:c,nullable:!1}),d={field:new foundry.data.fields.SetField(u),name:r,label:o,hint:i,value:a,options:c};return _classPrivateMethodGet(this,m,_addField2).call(this,d),this}},{key:"editor",value:function editor(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.HTMLField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,m,_addField2).call(this,c),this}},{key:"textArea",value:function textArea(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.JavaScriptField,name:r,label:o,hint:i,value:a,stacked:!0};return _classPrivateMethodGet(this,m,_addField2).call(this,c),this}},{key:"script",value:function script(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.JavaScriptField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,m,_addField2).call(this,c),this}},{key:"uuid",value:function uuid(t){var r,o=t.name,i=t.label,a=t.hint,c=t.value,u=t.type,d=t.multiple,p={field:new foundry.data.fields.DocumentUUIDField({type:u},{}),name:o,label:i,hint:a,value:c,type:u,multiple:d};return r=d?{field:new foundry.data.fields.SetField(p.field),name:o,label:i,hint:a,value:c,multiple:d}:p,_classPrivateMethodGet(this,m,_addField2).call(this,r),this}},{key:"button",value:function button(t){var r,o=t.label,i=t.action,a=t.icon,u=t.callback;null!==(r=i)&&void 0!==r||(i=foundry.utils.randomID());var button={action:i,type:"button",icon:a,label:o,callback:u};return _classPrivateFieldGet(this,c).push(button),this}}]),FormBuilder}();function _addField2(t){if(_classPrivateFieldGet(this,h)&&t.name){var r=foundry.utils.getProperty(_classPrivateFieldGet(this,h),t.name);void 0!==r&&(t.value=r)}return _classPrivateFieldGet(this,p)?_classPrivateFieldGet(this,p).fields.push(t):_classPrivateFieldGet(this,d)?_classPrivateFieldGet(this,d).fields.push(t):_classPrivateFieldGet(this,a).push(t)}var g={imagevideo:["IMAGE","VIDEO"],image:["IMAGE"],video:["VIDEO"],audio:["AUDIO"],font:["FONT"],graphics:["GRAPHICS"]};function inferSelectDataType(t){var r=Array.isArray(t)?t.map((function(t){return t.key})):Object.keys(t);try{if(r.every((function(t){return"number"==typeof JSON.parse(t)})))return Number}catch(t){return String}return String}var b=new WeakMap,w=new WeakMap,_=new WeakMap,k=new WeakSet,x=function(){formBuilder_inherits(FormHelper,foundry.applications.api.HandlebarsApplicationMixin(foundry.applications.api.ApplicationV2));var t=formBuilder_createSuper(FormHelper);function FormHelper(r){var o;formBuilder_classCallCheck(this,FormHelper);var i={};return r.buttons.forEach((function(t){return i[t.action]=t.callback})),_classPrivateMethodInitSpec(formBuilder_assertThisInitialized(o=t.call(this,formBuilder_objectSpread({actions:i},r.options))),k),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(o),b,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(o),w,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(o),_,{writable:!0,value:void 0}),FormHelper.registerPartial(),o.menu=r.settingsMenu,o.resolve,o.reject,o.promise=new Promise((function(t,r){o.resolve=t,o.reject=r})),o.onRenderFunction=r.options.onRender,_classPrivateFieldSet(formBuilder_assertThisInitialized(o),_,r.options.info),o.processFormStructure(r),o}return formBuilder_createClass(FormHelper,[{key:"processFormStructure",value:function processFormStructure(t){var r,o,i,a=this.menu?game.settings.get(this.menu.moduleId,this.menu.key):{},c=!!this.menu;if(null!==(r=t.tabs)&&void 0!==r&&r.length){this.__tabs={},t.tabs.find((function(t){return t.active}))||(t.tabs[0].active=!0);var u,d=formBuilder_createForOfIteratorHelper(t.tabs);try{for(d.s();!(u=d.n()).done;){var p,h,y=u.value;if(this.__tabs[y.id]={id:y.id,group:y.group,icon:y.icon,label:y.label,active:null!==(p=y.active)&&void 0!==p&&p,fields:null!==(h=y.fields)&&void 0!==h?h:[]},c){var m,v,g=formBuilder_createForOfIteratorHelper(null!==(m=y.fields)&&void 0!==m?m:[]);try{for(g.s();!(v=g.n()).done;){var _=v.value,k=foundry.utils.getProperty(a,_.name);void 0!==k&&(_.value=k)}}catch(t){g.e(t)}finally{g.f()}}}}catch(t){d.e(t)}finally{d.f()}}if(c){var x,P,S=formBuilder_createForOfIteratorHelper(null!==(x=t.fields)&&void 0!==x?x:[]);try{for(S.s();!(P=S.n()).done;){var T=P.value,E=foundry.utils.getProperty(a,T.name);void 0!==E&&(T.value=E)}}catch(t){S.e(t)}finally{S.f()}}_classPrivateFieldSet(this,b,null!==(o=t.fields)&&void 0!==o?o:[]),_classPrivateFieldSet(this,w,null!==(i=t.buttons)&&void 0!==i?i:[])}},{key:"_onClose",value:function _onClose(t){formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onClose",this).call(this,t),this.promise.resolved||this.resolve(!1)}},{key:"_prepareContext",value:function _prepareContext(t){return{tabs:_classPrivateMethodGet(this,k,_getTabs2).call(this),fields:_classPrivateFieldGet(this,b),info:_classPrivateFieldGet(this,_),buttons:[].concat(formBuilder_toConsumableArray(_classPrivateFieldGet(this,w).filter((function(t){return"submit"!==t.type}))),formBuilder_toConsumableArray(_classPrivateFieldGet(this,w).filter((function(t){return"submit"===t.type}))))}}},{key:"_onRender",value:function _onRender(t,r){formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onRender",this).call(this,t,r),this.__tabs||this.element.querySelector("nav").classList.add("hidden"),this.onRenderFunction&&this.onRenderFunction.bind(this)(t,r)}},{key:"changeTab",value:function changeTab(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];(t=formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"changeTab",this)).call.apply(t,[this].concat(o))}},{key:"_onChangeForm",value:function _onChangeForm(t,r){formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onChangeForm",this).call(this,t,r);new FormDataExtended(this.element)}},{key:"getFormData",value:function getFormData(){var t=new FormDataExtended(this.element);return foundry.utils.expandObject(t.object)}}],[{key:"registerPartial",value:function registerPartial(){if(!Handlebars.partials[o]){var t=Handlebars.compile(S);Handlebars.registerPartial(o,t)}}}]),FormHelper}();function _getTabs2(){for(var t,r=null!==(t=this.__tabs)&&void 0!==t?t:{},o=0,i=Object.values(r);o<i.length;o++){var a=i[o];if(a.cssClass=a.active?"active":"",a.active)break}return r}function _onSubmit3(){return(_onSubmit3=formBuilder_asyncToGenerator(formBuilder_regeneratorRuntime().mark((function _callee3(t,r,o){var i;return formBuilder_regeneratorRuntime().wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:if(i=foundry.utils.expandObject(o.object),this.resolve(i),!this.menu){t.next=6;break}return this.menu.requiresReload&&SettingsConfig.reloadConfirm(),this.menu.onChange&&this.menu.onChange(i),t.abrupt("return",game.settings.set(this.menu.moduleId,this.menu.key,i));case 6:case"end":return t.stop()}}),_callee3,this)})))).apply(this,arguments)}formBuilder_defineProperty(x,"DEFAULT_OPTIONS",{classes:["form-helper"],tag:"form",window:{contentClasses:["standard-form"]},position:{width:560,height:"auto"},form:{handler:function _classStaticPrivateMethodGet(t,r,o){return function _classCheckPrivateStaticAccess(t,r){if(t!==r)throw new TypeError("Private static access of wrong provenance")}(t,r),o}(x,x,(function _onSubmit(t,r,o){return _onSubmit3.apply(this,arguments)})),closeOnSubmit:!0},actions:{}}),formBuilder_defineProperty(x,"PARTS",{tabs:{template:"templates/generic/tab-navigation.hbs"},genericForm:{template:o,classes:["standard-form","scrollable"]},footer:{template:"templates/generic/form-footer.hbs"}});var P="\n    {{#if field.fieldset}}\n    <fieldset>\n        <legend>{{localize field.legend}}</legend>\n        {{#each field.fields as |f|}}\n        {{#if f.html}}{{{f.html}}}{{else}}\n        {{formField f.field stacked=f.stacked type=f.type label=f.label hint=f.hint name=f.name value=f.value min=f.min max=f.max step=f.step localize=true}}\n        {{/if}}\n        {{/each}}\n    </fieldset>\n    {{else}}\n    {{#if field.html}}{{{field.html}}}{{else}}\n    {{formField field.field stacked=field.stacked multiple=field.multiple type=field.type label=field.label hint=field.hint name=field.name value=field.value min=field.min max=field.max step=field.step localize=true}}\n    {{/if}}\n    {{/if}}\n        ",S='<div>\n    {{#if info}}{{{info}}}{{/if}}\n    {{#each tabs as |tab|}}\n\n    <section class="tab standard-form scrollable {{tab.cssClass}}" data-tab="{{tab.id}}" data-group="{{tab.group}}">\n        {{#each tab.fields as |field|}}\n        '.concat(P,"\n        {{/each}}\n    </section>\n\n    {{/each}}\n\n    {{#each fields as |field|}}\n    ").concat(P,"\n    {{/each}}\n</div>");function settings_typeof(t){return settings_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},settings_typeof(t)}function settings_regeneratorRuntime(){settings_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),d=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,d)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var h={};define(h,c,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(values([])));m&&m!==r&&o.call(m,c)&&(h=m);var v=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(h);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var d=tryCatch(t[i],t,a);if("throw"!==d.type){var p=d.arg,h=p.value;return h&&"object"==settings_typeof(h)&&o.call(h,"__await")?r.resolve(h.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(h).then((function(t){p.value=t,c(p)}),(function(t){return invoke("throw",t,c,u)}))}u(d.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var d=maybeInvokeDelegate(u,o);if(d){if(d===p)continue;return d}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var h=tryCatch(t,r,o);if("normal"===h.type){if(i=o.done?"completed":"suspendedYield",h.arg===p)continue;return{value:h.arg,done:o.done}}"throw"===h.type&&(i="completed",o.method="throw",o.arg=h.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(v,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,d,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,d,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(v),define(v,d,"Generator"),define(v,c,(function(){return this})),define(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),d=o.call(a,"finallyLoc");if(u&&d){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,p):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function settings_slicedToArray(t,r){return function settings_arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function settings_iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,c,u,d=[],p=!0,h=!1;try{if(c=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;p=!1}else for(;!(p=(i=c.call(o)).done)&&(d.push(i.value),d.length!==r);p=!0);}catch(t){h=!0,a=t}finally{try{if(!p&&null!=o.return&&(u=o.return(),Object(u)!==u))return}finally{if(h)throw a}}return d}}(t,r)||function settings_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return settings_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return settings_arrayLikeToArray(t,r)}(t,r)||function settings_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function settings_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function settings_asyncGeneratorStep(t,r,o,i,a,c,u){try{var d=t[c](u),p=d.value}catch(t){return void o(t)}d.done?r(p):Promise.resolve(p).then(i,a)}var T={},E=!1;function registerSettings(){!function registerSettingsArray(t){for(var r=function _loop(){var t=settings_slicedToArray(i[o],2),r=t[0],a=t[1];if(a.name||(a.name="".concat(D,".settings.").concat(r,".name")),a.hint||(a.hint="".concat(D,".settings.").concat(r,".hint")),void 0===a.useCache&&(a.useCache=E),a.useCache){var c=a.onChange;a.onChange&&(a.onChange=function(t){T[r]=t,c&&c(t)})}game.settings.register(D,r,a),a.useCache&&(T[r]=settings_getSetting(r))},o=0,i=Object.entries(t);o<i.length;o++)r()}({autoCheck:{scope:"world",config:!0,type:Boolean,default:!0},checkDisabled:{scope:"world",config:!0,type:Boolean,default:!1},viewedAnnouncements:{scope:"world",config:!1,type:Array,default:""},viewedUpdates:{scope:"world",config:!1,type:Object,default:{}},prevEnabledModules:{scope:"world",config:!1,type:Array,default:[]},lastGitCheck:{scope:"world",config:!1,type:Number,default:0}})}function settings_getSetting(t){var r;return null!==(r=T[t])&&void 0!==r?r:game.settings.get(D,t)}function _setSetting(){return _setSetting=function settings_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){settings_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){settings_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}(settings_regeneratorRuntime().mark((function _callee(t,r){return settings_regeneratorRuntime().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,game.settings.set(D,t,r);case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}}),_callee)}))),_setSetting.apply(this,arguments)}var G=!1;function initAutoRotation(){settings_getSetting("tweaks").autoRotate?(Hooks.on("preUpdateToken",onTokenPreUpdate),Hooks.on("targetToken",onTarget),Hooks.on("renderTokenConfig",onRenderTokenConfig),G=!0):G&&(Hooks.off("preUpdateToken",onTokenPreUpdate),Hooks.off("targetToken",onTarget),Hooks.off("renderTokenConfig",onRenderTokenConfig),G=!1)}function onTokenPreUpdate(t,r){if(void 0!==r.x||void 0!==r.y){var o,i,a,c;console.log({x:null!==(o=r.x)&&void 0!==o?o:t.x,y:null!==(i=r.y)&&void 0!==i?i:t.y,originalX:t.x,originalY:t.y});var u=getRotation(t,{x:null!==(a=r.x)&&void 0!==a?a:t.x,y:null!==(c=r.y)&&void 0!==c?c:t.y,width:t.width,height:t.height,parent:t.parent});!1!==u&&(r.rotation=u)}}function onTarget(t,r,o){if(o&&canvas.tokens.controlled.length){var i=canvas.tokens.controlled[0];if(r!==i){var a=getRotation(i.document,r.document);!1!==a&&i.document.update({rotation:a})}}}function onRenderTokenConfig(t){var r,o,i,a=t.document,c=null!==(r=t.element[0])&&void 0!==r?r:t.element,u=document.createElement("div");u.classList.add("form-group");var d=settings_getSetting("tweaks").autoRotate,p=l("".concat(D,1===d?".tweaks-menu.autoRotate.on":".tweaks-menu.autoRotate.off")),h=null!==(o=null===(i=a.flags[D])||void 0===i?void 0:i.autoRotate)&&void 0!==o?o:0;u.innerHTML="\n        <label>".concat(l("".concat(D,".tweaks-menu.autoRotate.name")),'</label>\n        <select name="flags.').concat(D,'.autoRotate" data-dtype="Number">\n            <option value="0" ').concat(0===h?"selected":"",">").concat(l("".concat(D,".tweaks-menu.autoRotate.default"))+" (".concat(p,")"),'</option>\n            <option value="1" ').concat(1===h?"selected":"",">").concat(l("".concat(D,".tweaks-menu.autoRotate.on")),'</option>\n            <option value="2" ').concat(2===h?"selected":"",">").concat(l("".concat(D,".tweaks-menu.autoRotate.off")),"</option>\n        </select>\n    "),c.querySelector('input[name="lockRotation"]').closest(".form-group").after(u),t.setPosition({height:"auto"})}function getRotation(t,r){var o,i;if(!(1===((null!==(o=null===(i=t.flags[D])||void 0===i?void 0:i.autoRotate)&&void 0!==o?o:0)||settings_getSetting("tweaks").autoRotate)))return!1;var a=t.x+t.width/2*t.parent.grid.sizeX,c=t.y+t.height/2*t.parent.grid.sizeY,u=r.x+r.width/2*r.parent.grid.sizeX,d=r.y+r.height/2*r.parent.grid.sizeY,p=Math.atan2(d-c,u-a);return Math.toDegrees(p-Math.PI/2)}var O=document.createElement("style");function applyCompactSidebar(){var t=settings_getSetting("tweaks").compactSidebar;O.innerHTML=t?"\n\n:root{\n    --sidebar-item-height: 32px;\n}\n\n.scenes-sidebar {\n    --sidebar-scene-height: 50px;\n}\n\n.compendium-sidebar .directory-item.compendium{\n    height: auto;\n    align-items: flex-start;\n    .entry-name.compendium-name{\n    margin: 0;\n    }\n    .compendium-footer{\n        display: none;\n    }\n}\n":"",document.head.appendChild(O)}function diceTray_typeof(t){return diceTray_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},diceTray_typeof(t)}function diceTray_ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function diceTray_objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?diceTray_ownKeys(Object(o),!0).forEach((function(r){diceTray_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):diceTray_ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function diceTray_defineProperty(t,r,o){return(r=function diceTray_toPropertyKey(t){var r=function diceTray_toPrimitive(t,r){if("object"!==diceTray_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==diceTray_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===diceTray_typeof(r)?r:String(r)}(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}var A=!1;function applyDiceTrayTweaks(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];settings_getSetting("tweaks").diceTray?(A||Hooks.on("renderChatLog",renderChatHook),A=!0):(A&&Hooks.off("renderChatLog",renderChatHook),A=!1),t||ui.chat.render(!0)}var L=["4","6","8","10","12","20","100"].map((function(t){return{name:"d".concat(t),icon:"dice-d".concat(t)}})),j={},I=diceTray_objectSpread({inProgress:!1,count:0},L.reduce((function(t,r){return diceTray_objectSpread(diceTray_objectSpread({},t),{},diceTray_defineProperty({},r.name,{count:0,adv:!1,dis:!1}))}),{}));function renderChatHook(t){if(!document.querySelector(".dice-tray-container")){var r=document.createElement("div");r.classList.add("dice-tray-container"),r.style.flex="0 0",r.style.height="3rem",r.style.minHeight="3rem",r.style.overflow="hidden";var o="";o+='<div class="flexrow">',L.forEach((function(t){if("d100"!==t.name){var r=t.name.toUpperCase();"d20"===t.name&&(r+=" (ALT → D100)"),o+='<button class="dice-tray-button" data-tooltip-direction="UP" data-tooltip="'.concat(r,'" data-button="dice|').concat(t.name,'"><i class="fad fa-').concat(t.icon,'"></i></button>')}})),o+='<div class="flexcol buttons-stacked">',o+='<button class="dice-tray-button" data-button="adv">ADV</button>',o+='<button class="dice-tray-button" data-button="count">+0</button>',o+='<button class="dice-tray-button" data-button="dis">DIS</button>',o+="</div>",o+='<button class="dice-tray-button" data-tooltip-direction="UP" data-tooltip="ROLL" data-button="roll"><i class="fas fa-dice"></i></button>',o+="</div>",r.innerHTML=o;var i=document.createElement("style");i.innerHTML="\n        .buttons-stacked{\n            align-items: center;\n            justify-content: space-around;\n            button{\n                font-size: x-small;\n                padding: 0;\n                max-height: 0.9rem;\n                padding: 0;\n            }\n        }\n        .dice-tray-button {\n            display: flex;\n            place-content: center;\n            align-items: center;\n            aspect-ratio: 1;\n            font-size: 1.4rem;\n            background: transparent;\n            border: none;\n            color: var(--color-text-light-highlight);\n            i{\n                margin: 0;\n            }\n        }\n         .dice-tray-button:hover{\n            background: var(--color-shadow-highlight);\n         }\n        .dice-tray-button:active, .dice-tray-button:focus{\n            border: none;\n            box-shadow: none;\n        }\n    ",r.appendChild(i),document.querySelector("#chat-form").after(r),r.querySelectorAll(".dice-tray-button").forEach((function(t){t.addEventListener("pointerup",onButtonClick)})),j=deepClone(I)}}function onButtonClick(t){t.preventDefault(),document.querySelector("#chat-form textarea").value.startsWith("/r ")||(j=deepClone(I));var r=t.currentTarget,o=0===t.button,i=2===t.button,a=t.shiftKey?2:t.ctrlKey?5:1,c="dice|d20"===r.dataset.button&&t.altKey?"dice|d100":r.dataset.button;if(r.style.transformOrigin=o?"bottom":"top",r.animate([{transform:"scale(1.1)"},{transform:"scale(1)"}],{duration:100}),"roll"===c){var u=t.altKey,d=deepClone(game.settings.get("core","diceConfiguration"));u&&game.settings.set("core","diceConfiguration",Object.keys(d).reduce((function(t,r){return diceTray_objectSpread(diceTray_objectSpread({},t),{},diceTray_defineProperty({},r,"manual"))}),{})),j=deepClone(I),document.querySelector(".dice-tray-button[data-button='count']").innerText="+0",o&&ui.chat.processMessage(document.querySelector("#chat-form textarea").value),u&&game.settings.set("core","diceConfiguration",d)}if(c.includes("dice|")){var p,h=c.split("|")[1];j.lastDice=h;var y=null!==(p=j[h].count)&&void 0!==p?p:0;o?y+=a:i&&y>0&&(y-=a),j[h].count=Math.max(0,y)}if("adv"===c||"dis"===c){var m=j.lastDice;if(!m)return;var v="adv"===c?"dis":"adv";j[m][v]=!1,j[m][c]=!j[m][c],j[m][c]&&j[m].count<2&&(j[m].count=2)}return"count"===c&&(j.count+=(i?-1:1)*a,r.innerText=j.count),function buildRoll(){var t=[];L.forEach((function(r){var o=r.name;0!==j[o].count&&t.push("".concat(j[o].count).concat(o).concat(j[o].adv?"kh":j[o].dis?"kl":""))})),0!==j.count&&t.push("".concat(j.count>0?"":"- ").concat(Math.abs(j.count)));if(0===t.length)return document.querySelector("#chat-form textarea").value="";document.querySelector("#chat-form textarea").value="/r ".concat(t.join(" + ").replace("+ -","-"))}()}var R=document.createElement("style");function applyCSSTweaks(){var t,r,o,i=(null!==(t=settings_getSetting("tweaks").cssTweak0)&&void 0!==t?t:"")+(null!==(r=settings_getSetting("tweaks").cssTweak1)&&void 0!==r?r:"")+(null!==(o=settings_getSetting("tweaks").cssTweak2)&&void 0!==o?o:"");R.innerHTML=i,document.head.appendChild(R)}var B,C=[],M=!1;function updateRegisterWrapper(t){void 0===t&&(t=settings_getSetting("tweaks").enableSettingsSwap),t?wrapRegister():function unwrapRegister(){ClientSettings.prototype.register=B}()}function registerFirst(){M||(M=!0,this.register(D,"ctwConfiguration",{scope:"world",config:!1,default:{},type:Object}),this.register(D,"tweaks",{scope:"world",config:!1,default:{},type:Object,onChange:function onChange(t){!function onUpdateTweaksMenu(){applyCSSTweaks(),applyCompactSidebar(),updateRegisterWrapper(),applyDiceTrayTweaks(),initAutoRotation()}()}}),updateRegisterWrapper())}function wrapRegister(){ClientSettings.prototype.register=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];try{var i,a;registerFirst.call(this);var c=r[0],u=r[1],d=r[2];if(c===D)return(i=B).call.apply(i,[this].concat(r));var p=settings_getSetting("ctwConfiguration");return p[c+u]&&p[c+u]!==d.scope&&(d.scope=p[c+u],C.push(c+"."+u)),(a=B).call.apply(a,[this].concat(r))}catch(t){var h;return console.error(t),(h=B).call.apply(h,[this].concat(r))}}}function config_typeof(t){return config_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},config_typeof(t)}function config_regeneratorRuntime(){config_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),d=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,d)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var h={};define(h,c,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(values([])));m&&m!==r&&o.call(m,c)&&(h=m);var v=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(h);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var d=tryCatch(t[i],t,a);if("throw"!==d.type){var p=d.arg,h=p.value;return h&&"object"==config_typeof(h)&&o.call(h,"__await")?r.resolve(h.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(h).then((function(t){p.value=t,c(p)}),(function(t){return invoke("throw",t,c,u)}))}u(d.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var d=maybeInvokeDelegate(u,o);if(d){if(d===p)continue;return d}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var h=tryCatch(t,r,o);if("normal"===h.type){if(i=o.done?"completed":"suspendedYield",h.arg===p)continue;return{value:h.arg,done:o.done}}"throw"===h.type&&(i="completed",o.method="throw",o.arg=h.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(v,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,d,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,d,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(v),define(v,d,"Generator"),define(v,c,(function(){return this})),define(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),d=o.call(a,"finallyLoc");if(u&&d){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,p):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function config_slicedToArray(t,r){return function config_arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function config_iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,c,u,d=[],p=!0,h=!1;try{if(c=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;p=!1}else for(;!(p=(i=c.call(o)).done)&&(d.push(i.value),d.length!==r);p=!0);}catch(t){h=!0,a=t}finally{try{if(!p&&null!=o.return&&(u=o.return(),Object(u)!==u))return}finally{if(h)throw a}}return d}}(t,r)||function config_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return config_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return config_arrayLikeToArray(t,r)}(t,r)||function config_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function config_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function config_asyncGeneratorStep(t,r,o,i,a,c,u){try{var d=t[c](u),p=d.value}catch(t){return void o(t)}d.done?r(p):Promise.resolve(p).then(i,a)}function config_initConfig(){game.user.isGM&&Hooks.on("renderSettingsConfig",(function(t,r,o){var i=r[0];function _generateSupportReport(){return _generateSupportReport=function config_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){config_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){config_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}(config_regeneratorRuntime().mark((function _callee(t){var r,o,i,a,c;return config_regeneratorRuntime().wrap((function _callee$(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,SupportDetails.generateSupportReport();case 2:return r=u.sent,o={"Core Version":r.coreVersion,System:r.systemVersion,Client:r.client,GPU:r.gpu,"Module Count":r.activeModuleCount},i=game.modules.get(t),o[i.title]=i.version,U.hub.getDependencies(t).forEach((function(t){o[t.title]=t.version})),a=Object.keys(o).map((function(t){return"<tr><td>".concat(t,"</td><td>").concat(o[t],"</td></tr>")})).join(""),c='<table style="margin:0;padding:0;">'.concat(a,"</table>"),u.next=12,utils_prompt("Support Report",c,{buttons:[{label:"Copy to Clipboard",action:"clipboard",icon:"fas fa-clipboard",callback:function callback(){var t=Object.entries(o).map((function(t){var r=config_slicedToArray(t,2),o=r[0],i=r[1];return"".concat(o,": ").concat(i)})).join("\n");game.clipboard.copyPlainText("```"+t+"```"),ui.notifications.info("Copied to Clipboard, please paste it along with your support request on discord.")}}]});case 12:case"end":return u.stop()}}),_callee)}))),_generateSupportReport.apply(this,arguments)}i.querySelectorAll(".tab.category").forEach((function(t){var r=t.getAttribute("data-tab"),o=game.modules.get(r);if(o){var i=Array.from(o.authors).some((function(t){return"theripper93"===t.name})),a=t.querySelector("h2");a.style.display="flex";var c=document.createElement("a");c.style.marginLeft="auto",c.classList.add("wiki-button");var u=o.download?"free":"paid";c.setAttribute("href","https://api.theripper93.com/modulewiki/".concat(r,"/").concat(u)),c.setAttribute("target","_blank"),c.innerHTML='<i data-tooltip="Open Documentation" class="fas fa-book"></i>',i&&a.appendChild(c);var d=document.createElement("a");d.style.marginLeft=i?"0.5rem":"auto",d.classList.add("wiki-button"),d.innerHTML='<i data-tooltip="Generate Support Report" class="fas fa-question-circle"></i>',d.addEventListener("click",(function(t){t.preventDefault(),function generateSupportReport(t){return _generateSupportReport.apply(this,arguments)}(r)})),a.appendChild(d);var p=document.createElement("a");p.style.marginLeft="0.5rem",p.classList.add("wiki-button"),p.innerHTML='<i data-tooltip="Troubleshoot" class="fas fa-tools"></i>',p.addEventListener("click",(function(t){t.preventDefault(),U.hub.troubleshoot(r)})),a.appendChild(p)}}));var a=i.querySelector('input[name="theripper-premium-hub.checkDisabled"]').closest(".form-group"),c=document.createElement("div");c.innerHTML="\n      ".concat(U.hub.announcementsHtml,'\n      <div class="form-group">\n      <a style="text-align: center;" href="https://theripper93.com/" target="_blank" rel="nofollow" title="https://theripper93.com/"><i class="fas fa-globe"></i> Visit my Website</a>\n          <button type="button">\n              <i class="fas fa-cogs"></i>\n              <label>Check for Updates</label>\n          </button>\n      </div>\n      '),c.querySelector("button").addEventListener("click",(function(t){t.preventDefault(),U.hub.displayOutdated(!0)})),a.after(c),i.querySelectorAll(".item.category-tab").forEach((function(t){var r=t.dataset.tab,o=U.hub.outdatedModules[r];o&&(t.innerHTML=t.innerHTML.replace(o.title,'<span><i style="color: var(--color-level-warning)" class="fas fa-circle-info"></i> '.concat(o.title,"</span>")),t.dataset.tooltip=game.i18n.format("SETUP.UpdateAvailable",{channel:o.title,version:o.version}))}))}))}var H="chat-welcome-message-shown";function runMacro(t){var r=fromUuidSync(t);if(r)return runScript(r);fromUuid(t).then((function(t){t&&runScript(t)}))}function runScript(t){if("script"!==t.type)return ui.notifications.error("Startup Macros: Macro is not a script macro");var r=t.command,o=new foundry.utils.AsyncFunction("{".concat(r,"\n}"));try{return o.call(t)}catch(t){ui.notifications.error("MACRO.Error",{localize:!0})}}function cleanHeaderButtons_typeof(t){return cleanHeaderButtons_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cleanHeaderButtons_typeof(t)}function cleanHeaderButtons_regeneratorRuntime(){cleanHeaderButtons_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),d=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,d)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var h={};define(h,c,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(values([])));m&&m!==r&&o.call(m,c)&&(h=m);var v=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(h);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var d=tryCatch(t[i],t,a);if("throw"!==d.type){var p=d.arg,h=p.value;return h&&"object"==cleanHeaderButtons_typeof(h)&&o.call(h,"__await")?r.resolve(h.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(h).then((function(t){p.value=t,c(p)}),(function(t){return invoke("throw",t,c,u)}))}u(d.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var d=maybeInvokeDelegate(u,o);if(d){if(d===p)continue;return d}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var h=tryCatch(t,r,o);if("normal"===h.type){if(i=o.done?"completed":"suspendedYield",h.arg===p)continue;return{value:h.arg,done:o.done}}"throw"===h.type&&(i="completed",o.method="throw",o.arg=h.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(v,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,d,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,d,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(v),define(v,d,"Generator"),define(v,c,(function(){return this})),define(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),d=o.call(a,"finallyLoc");if(u&&d){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,p):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function cleanHeaderButtons_asyncGeneratorStep(t,r,o,i,a,c,u){try{var d=t[c](u),p=d.value}catch(t){return void o(t)}d.done?r(p):Promise.resolve(p).then(i,a)}function registerCleanHeaderButtons(){settings_getSetting("tweaks").cleanHeaderButtons&&libWrapper.register("theripper-premium-hub","Application.prototype._renderOuter",function(){var t=function cleanHeaderButtons_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){cleanHeaderButtons_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){cleanHeaderButtons_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}(cleanHeaderButtons_regeneratorRuntime().mark((function _callee(t){var r,o,i,a,c=arguments;return cleanHeaderButtons_regeneratorRuntime().wrap((function _callee$(u){for(;;)switch(u.prev=u.next){case 0:for(r=c.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=c[i];return u.next=3,t.apply(void 0,o);case 3:return a=u.sent,setTimeout((function(){var t=a.find(".window-header")[0];t&&t.querySelectorAll(".header-button").forEach((function(t){var r=t.innerText.trim();r&&(t.dataset.tooltip=t.innerText,t.dataset.tooltipDirection="UP",t.innerHTML=t.innerHTML.replace(r,""))}))}),1),u.abrupt("return",a);case 6:case"end":return u.stop()}}),_callee)})));return function(r){return t.apply(this,arguments)}}())}function troubleshooter_typeof(t){return troubleshooter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},troubleshooter_typeof(t)}function troubleshooter_regeneratorRuntime(){troubleshooter_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),d=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,d)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var h={};define(h,c,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(values([])));m&&m!==r&&o.call(m,c)&&(h=m);var v=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(h);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var d=tryCatch(t[i],t,a);if("throw"!==d.type){var p=d.arg,h=p.value;return h&&"object"==troubleshooter_typeof(h)&&o.call(h,"__await")?r.resolve(h.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(h).then((function(t){p.value=t,c(p)}),(function(t){return invoke("throw",t,c,u)}))}u(d.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var d=maybeInvokeDelegate(u,o);if(d){if(d===p)continue;return d}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var h=tryCatch(t,r,o);if("normal"===h.type){if(i=o.done?"completed":"suspendedYield",h.arg===p)continue;return{value:h.arg,done:o.done}}"throw"===h.type&&(i="completed",o.method="throw",o.arg=h.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(v,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,d,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,d,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(v),define(v,d,"Generator"),define(v,c,(function(){return this})),define(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),d=o.call(a,"finallyLoc");if(u&&d){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,p):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function troubleshooter_slicedToArray(t,r){return function troubleshooter_arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function troubleshooter_iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,c,u,d=[],p=!0,h=!1;try{if(c=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;p=!1}else for(;!(p=(i=c.call(o)).done)&&(d.push(i.value),d.length!==r);p=!0);}catch(t){h=!0,a=t}finally{try{if(!p&&null!=o.return&&(u=o.return(),Object(u)!==u))return}finally{if(h)throw a}}return d}}(t,r)||function troubleshooter_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return troubleshooter_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return troubleshooter_arrayLikeToArray(t,r)}(t,r)||function troubleshooter_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function troubleshooter_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function troubleshooter_asyncGeneratorStep(t,r,o,i,a,c,u){try{var d=t[c](u),p=d.value}catch(t){return void o(t)}d.done?r(p):Promise.resolve(p).then(i,a)}function _reEnableModules(){return _reEnableModules=function troubleshooter_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){troubleshooter_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){troubleshooter_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}(troubleshooter_regeneratorRuntime().mark((function _callee(){var t,r,o,i,a,c,u;return troubleshooter_regeneratorRuntime().wrap((function _callee$(d){for(;;)switch(d.prev=d.next){case 0:if(t=game.settings.get("theripper-premium-hub","prevEnabledModules"),!(game.user.isGM&&t.length>0)){d.next=17;break}return d.next=4,utils_confirm("TheRipper93 Premium HUB","Would you like to re-enable your previously enabled modules?<br>Choose 'No' to disable this prompt, you will have to manually re-enable modules in the module management menu.<br>Close this prompt to be asked again on next refresh.");case 4:if(!1!==(r=d.sent)){d.next=8;break}return d.next=8,game.settings.set("theripper-premium-hub","prevEnabledModules",[]);case 8:if(r){d.next=10;break}return d.abrupt("return");case 10:for(o=game.settings.get("core",ModuleManagement.CONFIG_SETTING),i=0,a=Object.entries(o);i<a.length;i++)c=troubleshooter_slicedToArray(a[i],2),u=c[0],c[1],t.includes(u)&&(o[u]=!0);return d.next=14,game.settings.set("theripper-premium-hub","prevEnabledModules",[]);case 14:return d.next=16,game.settings.set("core",ModuleManagement.CONFIG_SETTING,o);case 16:foundry.utils.debouncedReload();case 17:case"end":return d.stop()}}),_callee)}))),_reEnableModules.apply(this,arguments)}var D="theripper-premium-hub",U={};!function initWorldToClient(){B=ClientSettings.prototype.register,wrapRegister(),Hooks.once("ready",(function(){!function initConfig(){if(!game.user.isGM)return;Hooks.on("renderSettingsConfig",(function(t,r){var o;settings_getSetting("tweaks").enableSettingsSwap&&(null!==(o=r[0])&&void 0!==o?o:r).querySelectorAll(".form-group[data-setting-id]").forEach((function(t){var r=t.dataset.settingId;if(r){var o=game.settings.settings.get(r);if(o){var i=C.includes(r);if("world"===(i?"world"===o.scope?"client":"world":o.scope)){var a=document.createElement("label");return a.innerText="🌎",a.style.marginRight="0.3rem",a.style.maxWidth="1rem",void t.prepend(a)}var c=document.createElement("select");c.style.maxWidth="3rem",c.style.marginRight="0.3rem",i&&(c.style.border="2px dotted var(--color-shadow-primary)");var u=document.createElement("option");u.value="world",u.text="🌎",u.selected="world"===o.scope,c.appendChild(u);var d=document.createElement("option");d.value="client",d.text="👤",d.selected="client"===o.scope,c.appendChild(d);var p=t.querySelector("label");t.prepend(c),c.addEventListener("change",(function(t){var o=t.target.value,i=settings_getSetting("ctwConfiguration");i[r.replace(".","")]=o,function setSetting(t,r){return _setSetting.apply(this,arguments)}("ctwConfiguration",i),ui.notifications.info(game.i18n.localize("".concat(D,".wtcNotification")).replace("{setting}",p.textContent).replace("{value}",o))}))}}}))}))}()}))}(),Hooks.on("init",(function(){registerSettings(),function registerTweaksMenu(){(new v).title("".concat(D,".tweaks-menu.title")).tab({id:"misc",label:"".concat(D,".tweaks-menu.tabs.misc"),icon:"fas fa-wrench"}).checkbox({name:"cleanHeaderButtons",label:"".concat(D,".tweaks-menu.cleanHeaderButtons.name"),hint:"".concat(D,".tweaks-menu.cleanHeaderButtons.hint"),value:!1}).checkbox({name:"compactSidebar",label:"".concat(D,".tweaks-menu.compactSidebar.name"),hint:"".concat(D,".tweaks-menu.compactSidebar.hint"),value:!1}).checkbox({name:"enableSettingsSwap",label:"".concat(D,".tweaks-menu.enableSettingsSwap.name"),hint:"".concat(D,".tweaks-menu.enableSettingsSwap.hint"),value:!1}).checkbox({name:"diceTray",label:"".concat(D,".tweaks-menu.diceTray.name"),hint:"".concat(D,".tweaks-menu.diceTray.hint"),value:!1}).select({name:"autoRotate",label:"".concat(D,".tweaks-menu.autoRotate.name"),hint:"".concat(D,".tweaks-menu.autoRotate.hint"),options:{0:"".concat(D,".tweaks-menu.autoRotate.none"),1:"".concat(D,".tweaks-menu.autoRotate.defaultOn"),2:"".concat(D,".tweaks-menu.autoRotate.defaultOff")},value:0}).tab({id:"startup-macros",label:"".concat(D,".tweaks-menu.tabs.startup-macros"),icon:"fas fa-magic"}).uuid({name:"readyMacros",label:"".concat(D,".tweaks-menu.readyMacros.name"),hint:"".concat(D,".tweaks-menu.readyMacros.hint"),multiple:!0,type:"Macro",value:[]}).tab({id:"css-tweaks",label:"".concat(D,".tweaks-menu.tabs.css-tweaks"),icon:"fas fa-palette"}).textArea({name:"cssTweak0",label:"".concat(D,".tweaks-menu.cssTweak.name")}).textArea({name:"cssTweak1",label:"".concat(D,".tweaks-menu.cssTweak.name")}).textArea({name:"cssTweak2",label:"".concat(D,".tweaks-menu.cssTweak.name")}).registerAsMenu({moduleId:D,key:"tweaks",name:"".concat(D,".tweaks-menu.title"),label:"".concat(D,".tweaks-menu.label"),hint:"".concat(D,".tweaks-menu.hint"),icon:"fas fa-tools",scope:"world",defaultValue:{}})}(),registerCleanHeaderButtons(),applyCSSTweaks(),applyCompactSidebar(),applyDiceTrayTweaks(!0),initAutoRotation()})),Hooks.on("ready",(function(){!function showWelcome(){if(game.user.isGM){var t=game.modules.get(D),r="2Iq_so_GsLA",o='<iframe width="100%" height="auto" src="https://www.youtube.com/embed/'.concat(r,'" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'),i=t.protected?"https://wiki.theripper93.com/premium/".concat(D):"https://wiki.theripper93.com/free/".concat(D),a="<h1>".concat(t.title,'</h1>\n    <p>by <a href="https://theripper93.com">theripper93</a></p>\n    <p><strong>New to ').concat(t.title,'? Visit the <a href="').concat(i,'">Wiki</a> for a quickstart guide and resources.</strong></p>\n    ').concat(r?o:"",'\n    <p>Special thanks to all my <a href="https://www.patreon.com/theripper93">Patreons</a> for making ongoing updates and development possible. Supporting gives you access to <strong>30+ premium modules</strong> and <strong>priority support</strong>.</p>\n    <p><strong>Explore all resources and modules:</strong></p> <ul>\n    <li><a href="https://theripper93.com/">Check out all my free and premium modules</a></li>\n    <li><a href="').concat(i,'">').concat(t.title,' Wiki</a></li>\n    <li><a href="https://www.patreon.com/theripper93">Support on Patreon</a></li>\n    <li><a href="https://discord.theripper93.com/">Discord Channel</a></li>\n    </ul>');game.settings.register(D,H,{default:!1,type:Boolean,scope:"world",config:!1}),game.settings.get(D,H)||(ChatMessage.create({user:game.user.id,whisper:game.users.filter((function(t){return t.isGM})).map((function(t){return t.id})),blind:!0,content:a}),game.settings.set(D,H,!0))}}(),config_initConfig(),function runReadyMacros(){var t;(null!==(t=settings_getSetting("tweaks").readyMacros)&&void 0!==t?t:[]).forEach((function(t){runMacro(t)}))}(),game.user.isGM&&(!function reEnableModules(){return _reEnableModules.apply(this,arguments)}(),U.hub=new r)}))})();
//# sourceMappingURL=index.js.map